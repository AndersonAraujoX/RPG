<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minerador de Cliques</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        rpg: {
                            black: '#0B0C10',
                            cyan: '#66FCF1',
                            slate: '#1F2833',
                            silver: '#C5C6C7',
                        }
                    }
                }
            }
        }
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Inter:wght@400;600&display=swap"
        rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0B0C10;
            background-image: url('https://www.transparenttextures.com/patterns/dark-matter.png');
            color: #C5C6C7;
            user-select: none;
        }

        h1,
        h2,
        h3 {
            font-family: 'Cinzel', serif;
        }

        .text-shadow {
            text-shadow: 0 0 10px rgba(102, 252, 241, 0.5);
        }

        .game-container {
            max-width: 1400px;
            margin: auto;
            padding: 20px;
        }

        .mine-rock {
            transition: transform 0.1s ease-in-out;
            cursor: pointer;
            filter: drop-shadow(0 0 20px rgba(102, 252, 241, 0.2));
        }

        .mine-rock:hover {
            filter: drop-shadow(0 0 30px rgba(102, 252, 241, 0.4));
        }

        .mine-rock:active {
            transform: scale(0.95);
        }

        .upgrade-item {
            border: 1px solid #1F2833;
            background-color: rgba(11, 12, 16, 0.6);
            transition: all 0.2s;
        }

        .upgrade-item.disabled {
            opacity: 0.5;
            cursor: not-allowed;
            border-color: #374151;
        }

        .upgrade-item:not(.disabled):hover {
            background-color: rgba(31, 40, 51, 0.8);
            border-color: #66FCF1;
            box-shadow: 0 0 10px rgba(102, 252, 241, 0.1);
        }

        .floating-text {
            position: absolute;
            font-size: 20px;
            font-weight: bold;
            color: #66FCF1;
            pointer-events: none;
            animation: floatUp 1.5s ease-out forwards;
            text-shadow: 0 0 5px #000;
        }

        .floating-text.rare {
            color: #FBBF24;
            /* Amber for rare */
            font-size: 22px;
            animation-duration: 2s;
            text-shadow: 0 0 10px #FBBF24;
        }

        .floating-text.passive {
            color: #A5F3FC;
            /* Light Cyan */
            font-size: 18px;
            animation-duration: 2.5s;
        }

        @keyframes floatUp {
            from {
                opacity: 1;
                transform: translateY(0);
            }

            to {
                opacity: 0;
                transform: translateY(-100px);
            }
        }
    </style>
</head>

<body class="overflow-x-hidden">

    <div class="game-container min-h-screen flex flex-col items-center justify-center">
        <header class="w-full relative flex justify-center mb-8">
            <a href="index.html"
                class="absolute top-2 left-0 text-sm text-gray-500 hover:text-rpg-cyan transition-colors">&larr;
                Voltar</a>
            <h1 class="text-4xl md:text-5xl text-center text-shadow text-rpg-cyan">Escavação Profunda</h1>
        </header>

        <div class="w-full grid grid-cols-1 lg:grid-cols-3 gap-8">

            <!-- Seção de Mineração (Esquerda/Centro) -->
            <div class="lg:col-span-2 flex flex-col items-center justify-start p-6 bg-rpg-slate/80 rounded-xl border border-rpg-cyan/30 shadow-2xl relative backdrop-blur-sm"
                id="mine-section">
                <!-- Painel de Recursos -->
                <div class="w-full mb-6">
                    <div class="text-center w-full bg-black/40 p-6 rounded-xl mb-6 border border-gray-700 shadow-inner">
                        <h2 id="ore-count" class="text-6xl text-rpg-silver font-cinzel">0</h2>
                        <p class="text-lg text-rpg-cyan mt-2">Minério Bruto</p>
                        <p id="ops-count" class="text-sm mt-1 text-gray-500 font-mono">0 / seg</p>
                    </div>
                    <div id="rare-resources-display"
                        class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 text-xs">
                        <!-- Recursos raros serão inseridos aqui -->
                    </div>
                </div>

                <div id="mine-rock" class="mine-rock py-8">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200" class="w-64 h-64 md:w-80 md:h-80">
                        <defs>
                            <filter id="rock-texture" x="-20%" y="-20%" width="140%" height="140%">
                                <feTurbulence type="fractalNoise" baseFrequency="0.05" numOctaves="4" result="noise" />
                                <feDiffuseLighting in="noise" lighting-color="#4B5563" surfaceScale="3"
                                    result="diffuse">
                                    <feDistantLight azimuth="45" elevation="60" />
                                </feDiffuseLighting>
                                <feComposite operator="in" in2="SourceGraphic" result="textured" />
                            </filter>
                            <radialGradient id="rock-gradient" cx="50%" cy="50%" r="50%" fx="50%" fy="50%">
                                <stop offset="0%" style="stop-color:#374151" /> <!-- Gray 700 -->
                                <stop offset="100%" style="stop-color:#111827" /> <!-- Gray 900 -->
                            </radialGradient>
                        </defs>
                        <!-- Rock Shape -->
                        <path
                            d="M 50,20 Q 80,10 120,30 T 170,50 Q 190,80 175,120 T 130,170 Q 100,190 60,175 T 20,130 Q 10,100 25,70 T 50,20 Z"
                            fill="url(#rock-gradient)" filter="url(#rock-texture)" stroke="#1F2937" stroke-width="2" />

                        <!-- Veios de Energia (Cyan) -->
                        <path d="M 70,40 Q 80,50 90,30" stroke="#66FCF1" stroke-width="2" fill="none"
                            class="animate-pulse"
                            style="animation-duration: 3s; opacity: 0.8; filter: drop-shadow(0 0 2px #66FCF1);" />
                        <path d="M 120,60 Q 130,75 140,55" stroke="#66FCF1" stroke-width="1.5" fill="none"
                            class="animate-pulse"
                            style="animation-duration: 4s; opacity: 0.6; filter: drop-shadow(0 0 2px #66FCF1);" />
                        <path d="M 50,140 Q 65,150 80,130" stroke="#66FCF1" stroke-width="2" fill="none"
                            class="animate-pulse"
                            style="animation-duration: 3.5s; opacity: 0.7; filter: drop-shadow(0 0 2px #66FCF1);" />
                        <path d="M 150,130 Q 140,145 160,150" stroke="#C5C6C7" stroke-width="1" fill="none"
                            opacity="0.5" />
                    </svg>
                </div>
            </div>

            <!-- Loja de Melhorias (Direita) -->
            <div
                class="p-6 bg-rpg-slate/80 rounded-xl border border-rpg-cyan/30 shadow-2xl backdrop-blur-sm flex flex-col h-[600px]">
                <h2 class="text-2xl text-center mb-6 text-rpg-cyan border-b border-gray-700 pb-4">Tecnologia de Extração
                </h2>
                <div id="store" class="space-y-3 overflow-y-auto flex-1 pr-2 custom-scrollbar">
                    <!-- Itens da loja serão inseridos aqui pelo JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- ESTADO DO JOGO ---
        let resources = {
            'Minério Comum': 0, 'Ferrolama': 0, 'Coral-Fantasma': 0, 'Veio Escarlate': 0,
            'Quartzo Sônico': 0, 'Magnetita Anômala': 0, 'Pirita do Engano': 0, 'Coral-Rocha': 0,
            'Titânio Crepuscular': 0, 'Obsidiana da Névoa': 0, 'Geodo-Eco': 0,
            'Basalto Estabilizador': 0, 'Criptometal': 0
        };
        let oresPerClick = 1;
        let oresPerSecond = 0;
        let passiveDropRemainders = {};

        // --- CONFIGURAÇÕES DO JOGO ---
        const upgrades = {
            pickaxe: { level: 0, baseCost: 15, costMultiplier: 1.15, basePower: 1, label: "Picareta Melhor", description: (power) => `+${power} por clique.` },
            dwarf: { level: 0, baseCost: 100, costMultiplier: 1.2, basePower: 1, label: "Mineiro Anão", description: (power) => `+${power} por seg.` },
            mineCart: { level: 0, baseCost: 1100, costMultiplier: 1.25, basePower: 8, label: "Carrinho de Mina", description: (power) => `+${power} por seg.` },
            excavator: { level: 0, baseCost: 12000, costMultiplier: 1.3, basePower: 47, label: "Escavadeira", description: (power) => `+${power} por seg.` },
            quarry: { level: 0, baseCost: 130000, costMultiplier: 1.35, basePower: 260, label: "Pedreira Automatizada", description: (power) => `+${power} por seg.` },
            planetDrill: { level: 0, baseCost: 1400000, costMultiplier: 1.4, basePower: 1400, label: "Broca Planetária", description: (power) => `+${power} por seg.` }
        };

        const rareOreDropTable = [
            // Nome e chance base para uma curva exponencial
            { name: 'Ferrolama', baseChance: 0.08, multiplier: 0.65, index: 0 },
            { name: 'Geodo-Eco', baseChance: 0.008, multiplier: 0.65, index: 1 },
            { name: 'Coral-Rocha', baseChance: 0.0008, multiplier: 0.65, index: 2 },
            { name: 'Coral-Fantasma', baseChance: 0.00008, multiplier: 0.65, index: 3 },
            { name: 'Quartzo Sônico', baseChance: 0.000008, multiplier: 0.65, index: 4 },
            { name: 'Titânio Crepuscular', baseChance: 0.0000008, multiplier: 0.65, index: 5 },
            { name: 'Obsidiana da Névoa', baseChance: 0.000000008, multiplier: 0.65, index: 6 },
            { name: 'Veio Escarlate', baseChance: 0.00000000008, multiplier: 0.65, index: 7 },
            { name: 'Basalto Estabilizador', baseChance: 0.00000000008, multiplier: 0.65, index: 8 },
            { name: 'Magnetita Anômala', baseChance: 0.00000000008, multiplier: 0.65, index: 9 },
            { name: 'Criptometal', baseChance: 0.000000000008, multiplier: 0.65, index: 10 },
            { name: 'Pirita do Engano', baseChance: 0.00000000000008, multiplier: 0.65, index: 11 }
        ].map(ore => ({ ...ore, chance: ore.baseChance * Math.pow(ore.multiplier, ore.index) }));


        // --- ELEMENTOS DO DOM ---
        const oreCountElement = document.getElementById('ore-count');
        const opsCountElement = document.getElementById('ops-count');
        const mineRockElement = document.getElementById('mine-rock');
        const mineSectionElement = document.getElementById('mine-section');
        const storeElement = document.getElementById('store');
        const rareResourcesDisplay = document.getElementById('rare-resources-display');

        // --- FUNÇÕES DO JOGO ---

        function formatNumber(num) {
            num = Math.floor(num);
            if (num < 1000) return num.toString();
            const suffixes = ["", "mil", "M", "B", "T"];
            const i = Math.floor(Math.log10(num) / 3);
            let value = (num / Math.pow(1000, i)).toFixed(2);
            if (value.endsWith('.00')) value = value.slice(0, -3);
            return value + suffixes[i];
        }

        function calculateCost(upgradeKey) {
            const upgrade = upgrades[upgradeKey];
            return Math.ceil(upgrade.baseCost * Math.pow(upgrade.costMultiplier, upgrade.level));
        }

        function updateDisplay() {
            oreCountElement.textContent = formatNumber(resources['Minério Comum']);
            opsCountElement.textContent = `${formatNumber(oresPerSecond)} por segundo`;

            Object.keys(resources).forEach(key => {
                if (key !== 'Minério Comum') {
                    const resourceElement = document.getElementById(`resource-${key.replace(/\s/g, '-')}`);
                    if (resourceElement) {
                        resourceElement.querySelector('.amount').textContent = formatNumber(resources[key]);
                    }
                }
            });

            const commonOres = resources['Minério Comum'];
            Object.keys(upgrades).forEach(key => {
                const itemElement = document.getElementById(`upgrade-${key}`);
                const cost = calculateCost(key);
                if (itemElement) {
                    itemElement.querySelector('.cost').textContent = `Custo: ${formatNumber(cost)}`;
                    itemElement.querySelector('.level').textContent = upgrades[key].level;

                    if (commonOres >= cost) {
                        itemElement.classList.remove('disabled');
                        itemElement.querySelector('button').disabled = false;
                    } else {
                        itemElement.classList.add('disabled');
                        itemElement.querySelector('button').disabled = true;
                    }
                }
            });
        }

        function createFloatingText(text, pos, isRare = false, isPassive = false) {
            const textEl = document.createElement('div');
            textEl.className = 'floating-text';
            if (isPassive) textEl.classList.add('passive');
            if (isRare) textEl.classList.add('rare');
            textEl.textContent = text;

            const rect = mineSectionElement.getBoundingClientRect();
            textEl.style.left = `${pos.x - rect.left}px`;
            textEl.style.top = `${pos.y - rect.top}px`;

            mineSectionElement.appendChild(textEl);

            setTimeout(() => textEl.remove(), isPassive ? 2500 : (isRare ? 2000 : 1500));
        }

        function createPassiveFloatingText(text) {
            const rockRect = mineRockElement.getBoundingClientRect();
            const x = rockRect.left + (rockRect.width / 2) + (Math.random() - 0.5) * 80;
            const y = rockRect.top + (rockRect.height / 2) + (Math.random() - 0.5) * 80;
            createFloatingText(text, { clientX: x, clientY: y }, true, true);
        }

        function mineOre(event) {
            resources['Minério Comum'] += oresPerClick;
            createFloatingText(`+${formatNumber(oresPerClick)}`, { clientX: event.clientX, clientY: event.clientY });

            rareOreDropTable.forEach(ore => {
                if (Math.random() < ore.chance) {
                    resources[ore.name]++;
                    createFloatingText(`+1 ${ore.name}`, { clientX: event.clientX, clientY: event.clientY }, true);
                }
            });

            updateDisplay();
        }

        function buyUpgrade(key) {
            const upgrade = upgrades[key];
            const cost = calculateCost(key);

            if (resources['Minério Comum'] >= cost) {
                resources['Minério Comum'] -= cost;
                upgrade.level++;

                if (key === 'pickaxe') {
                    oresPerClick = 1 + upgrades.pickaxe.level * upgrades.pickaxe.basePower;
                } else {
                    oresPerSecond = 0;
                    Object.keys(upgrades).forEach(k => {
                        if (k !== 'pickaxe') {
                            oresPerSecond += upgrades[k].level * upgrades[k].basePower;
                        }
                    });
                }

                updateDisplay();
            }
        }

        function renderStore() {
            let storeHTML = '';
            Object.keys(upgrades).forEach(key => {
                const upgrade = upgrades[key];
                storeHTML += `
                    <div id="upgrade-${key}" class="upgrade-item p-4 rounded-lg flex justify-between items-center disabled group">
                        <div class="flex-1">
                            <h3 class="text-sm font-bold text-rpg-silver group-hover:text-rpg-cyan transition-colors">${upgrade.label} <span class="text-xs text-gray-500">(Nvl <span class="level text-white">0</span>)</span></h3>
                            <p class="text-xs text-gray-400 mt-1">${upgrade.description(upgrade.basePower)}</p>
                            <p class="text-xs text-rpg-cyan font-mono mt-1 cost">Custo: ${formatNumber(upgrade.baseCost)}</p>
                        </div>
                        <button onclick="buyUpgrade('${key}')" class="ml-3 bg-rpg-black hover:bg-rpg-cyan hover:text-black text-rpg-cyan font-bold py-2 px-4 text-xs rounded border border-rpg-cyan transition-all uppercase tracking-wider">
                            Obter
                        </button>
                    </div>
                `;
            });
            storeElement.innerHTML = storeHTML;
        }

        function renderRareResources() {
            let resourcesHTML = '';
            Object.keys(resources).forEach(key => {
                if (key !== 'Minério Comum') {
                    const nameSlug = key.replace(/\s/g, '-');
                    passiveDropRemainders[key] = 0; // Inicializa os remainders
                    resourcesHTML += `
                        <div id="resource-${nameSlug}" class="bg-black/40 p-2 rounded-lg border border-gray-800 flex flex-col items-center text-center hover:border-gray-600 transition-colors">
                           <span class="font-bold text-rpg-cyan amount text-sm font-mono">0</span>
                           <span class="text-[10px] text-gray-400 uppercase tracking-wide mt-1">${key}</span>
                        </div>
                    `;
                }
            });
            rareResourcesDisplay.innerHTML = resourcesHTML;
        }

        // --- LOOP PRINCIPAL DO JOGO ---
        function gameLoop() {
            const passiveChecks = oresPerSecond / 10;
            resources['Minério Comum'] += passiveChecks;

            rareOreDropTable.forEach(ore => {
                const potentialDrops = passiveChecks * ore.chance;
                passiveDropRemainders[ore.name] += potentialDrops;

                if (passiveDropRemainders[ore.name] >= 1) {
                    const oresFound = Math.floor(passiveDropRemainders[ore.name]);
                    resources[ore.name] += oresFound;
                    passiveDropRemainders[ore.name] -= oresFound;
                    createPassiveFloatingText(`+${oresFound} ${ore.name}`);
                }
            });

            updateDisplay();
        }

        // --- INICIALIZAÇÃO ---
        mineRockElement.addEventListener('click', mineOre);
        renderStore();
        renderRareResources();
        setInterval(gameLoop, 100);
    </script>
</body>

</html>